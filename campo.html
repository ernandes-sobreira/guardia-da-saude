<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Guardi√£s da Vigil√¢ncia üå± | Campo (Avan√ßado)</title>
<meta name="theme-color" content="#d946ef"/>

<style>
:root{
  --bg0:#fff6fb;
  --bg1:#ffe4f3;
  --card: rgba(255,255,255,.78);
  --stroke: rgba(79,12,55,.14);
  --txt:#2a0f22;
  --muted: rgba(42,15,34,.65);
  --pink:#d946ef;
  --violet:#8b5cf6;
  --teal:#06b6d4;
  --green:#22c55e;
  --gold:#f59e0b;
  --r:20px;
  --shadow: 0 18px 60px rgba(80,10,55,.18);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:
    radial-gradient(900px 600px at 10% 0%, rgba(217,70,239,.18), transparent 55%),
    radial-gradient(800px 600px at 90% 10%, rgba(139,92,246,.18), transparent 55%),
    linear-gradient(180deg,var(--bg0),var(--bg1));
  color:var(--txt);
}

header{
  position:sticky;top:0;z-index:20;
  background:rgba(255,246,251,.9);
  backdrop-filter: blur(10px);
  border-bottom:1px solid var(--stroke);
}
header .h{
  max-width:1100px;margin:auto;padding:14px 16px;
  display:flex;gap:12px;align-items:center;
}
.logo{
  width:46px;height:46px;border-radius:18px;
  display:grid;place-items:center;
  background:linear-gradient(135deg,var(--pink),var(--violet));
  color:white;font-size:22px;box-shadow:var(--shadow);
}
header h1{margin:0;font-size:16px}
header p{margin:2px 0 0;font-size:12px;color:var(--muted)}

main{
  max-width:1100px;margin:auto;
  padding:16px 16px 120px;
  display:grid;grid-template-columns:360px 1fr;gap:14px;
}
@media(max-width:900px){main{grid-template-columns:1fr}}

.panel{
  background:var(--card);
  border:1px solid var(--stroke);
  border-radius:var(--r);
  box-shadow:var(--shadow);
}
.ph{padding:14px;border-bottom:1px solid var(--stroke)}
.pb{padding:14px}

.lesson-btn{
  width:100%;text-align:left;
  padding:12px;margin-bottom:8px;
  border-radius:16px;border:1px solid transparent;
  background:rgba(255,255,255,.6);cursor:pointer;
}
.lesson-btn.active{
  border-color:var(--pink);
  background:rgba(217,70,239,.12);
}
.lesson-btn b{display:block;font-size:13px}
.lesson-btn span{font-size:12px;color:var(--muted)}

.content{line-height:1.75}
.content h3{margin-top:14px}

.callout{
  background:rgba(217,70,239,.08);
  border-left:4px solid var(--pink);
  padding:12px;border-radius:14px;margin:12px 0;
}
.eco{
  background:rgba(6,182,212,.08);
  border-left:4px solid var(--teal);
  padding:12px;border-radius:14px;margin:12px 0;
}
.warn{
  background:rgba(245,158,11,.12);
  border-left:4px solid var(--gold);
  padding:12px;border-radius:14px;margin:12px 0;
}

/* checklist */
.check{
  display:flex;gap:10px;margin:8px 0;
  align-items:flex-start;
}
.check input{transform: translateY(2px);}

/* progress */
.progress-wrap{
  margin-top:10px;
  display:grid;
  gap:10px;
}
.prog{
  background:rgba(255,255,255,.6);
  border:1px solid var(--stroke);
  border-radius:999px;
  overflow:hidden;
  height:12px;
}
.prog > div{
  height:100%;
  width:0%;
  background:linear-gradient(135deg,var(--pink),var(--violet));
  transition:width .25s ease;
}
.prog-meta{
  display:flex;justify-content:space-between;
  font-size:12px;color:var(--muted);
}

/* bottom menu injected by menu.js */
</style>
</head>

<body>

<header>
  <div class="h">
    <div class="logo">üå±</div>
    <div>
      <h1>M√≥dulo de Campo ‚Äî Vigil√¢ncia Entomol√≥gica Avan√ßada</h1>
      <p>Onde o territ√≥rio explica o vetor, e o vetor explica a doen√ßa</p>

      <div class="progress-wrap">
        <div class="prog-meta">
          <span>Progresso da li√ß√£o</span>
          <span id="lessonPct">0%</span>
        </div>
        <div class="prog"><div id="lessonBar"></div></div>

        <div class="prog-meta">
          <span>Progresso do m√≥dulo</span>
          <span id="modulePct">0%</span>
        </div>
        <div class="prog"><div id="moduleBar"></div></div>
      </div>

    </div>
  </div>
</header>

<main>

<aside class="panel">
  <div class="ph"><h2>üß≠ Roteiros de Observa√ß√£o</h2></div>
  <div class="pb" id="menu"></div>
</aside>

<section class="panel">
  <div class="ph">
    <h2 id="title">Selecione um ambiente</h2>
    <p id="subtitle" style="font-size:12px;color:var(--muted)"></p>
  </div>
  <div class="pb content" id="content"></div>
</section>

</main>

<!-- menu fixo (o seu menu.js + caderno-global.js) -->
<div id="app-menu"></div>
<script src="menu.js"></script>
<script src="caderno-global.js"></script>

<script>
/* ========= CONTE√öDO ========= */
const lessons = [
{
  id:"campo_epi",
  title:"üß§ Antes de sair: Seguran√ßa & EPIs",
  sub:"O campo come√ßa com prote√ß√£o e √©tica",
  html:`
    <h3>EPIs obrigat√≥rios (sem negocia√ß√£o)</h3>
    <div class="warn">
      <ul>
        <li><b>Bota fechada</b> (ou t√™nis resistente) + meia</li>
        <li><b>Cal√ßa comprida</b> (preferir tecido mais grosso)</li>
        <li><b>Camisa manga longa</b> (ou protetor UV)</li>
        <li><b>Repelente</b> aplicado e reaplicado</li>
        <li><b>Bon√©/chap√©u</b> e √°gua para hidrata√ß√£o</li>
        <li><b>Luvas</b> quando houver risco (lixo, mato fechado, material sujo)</li>
      </ul>
      <p style="margin:0"><b>Nunca</b> coletar com a m√£o nua. Observa√ß√£o > captura.</p>
    </div>

    <h3>Postura √©tica no territ√≥rio</h3>
    <div class="callout">
      <ul>
        <li>N√£o invadir quintais/√°reas privadas sem autoriza√ß√£o</li>
        <li>N√£o expor pessoas ou endere√ßos em fotos</li>
        <li>Foco em <b>ambiente</b>, n√£o em ‚Äúculpar‚Äù moradores</li>
      </ul>
    </div>

    <h3>Checklist (obrigat√≥rio)</h3>
    <div class="check"><input data-save type="checkbox" data-key="epi_bota"> <span>Estou com bota/t√™nis fechado e roupa adequada</span></div>
    <div class="check"><input data-save type="checkbox" data-key="epi_rep"> <span>Estou com repelente (e sei a hora de reaplicar)</span></div>
    <div class="check"><input data-save type="checkbox" data-key="epi_agua"> <span>Estou com √°gua e pausas planejadas</span></div>
    <div class="check"><input data-save type="checkbox" data-key="epi_etica"> <span>Entendi as regras de √©tica (sem invas√£o/sem exposi√ß√£o)</span></div>
  `
},
{
  id:"agua_artificial",
  title:"1Ô∏è‚É£ √Ågua parada artificial (urbano)",
  sub:"Baldes, pneus, caixas, recipientes dom√©sticos",
  html:`
    <h3>O que define este ambiente?</h3>
    <p>S√£o criadouros criados pela a√ß√£o humana, onde a √°gua se acumula e permite o desenvolvimento de larvas.</p>

    <div class="eco">
      <b>Vetores associados</b>
      <ul>
        <li>Mosquitos urbanos (ex.: <b>Aedes</b>)</li>
        <li>Fase dominante: <b>larvas e pupas</b></li>
      </ul>
    </div>

    <h3>Por que o vetor escolhe esse local?</h3>
    <ul>
      <li>√Ågua relativamente limpa</li>
      <li>Baixa presen√ßa de predadores</li>
      <li>Proximidade com pessoas (alimento para o mosquito adulto)</li>
    </ul>

    <div class="callout">
      <b>Rela√ß√£o com doen√ßas</b>
      <p style="margin:6px 0 0">Dengue, Zika e Chikungunya dependem diretamente da exist√™ncia desses microambientes.</p>
    </div>

    <h3>Checklist de campo</h3>
    <div class="check"><input data-save type="checkbox" data-key="a1_tipos"> <span>Identifiquei 3 tipos diferentes de recipientes</span></div>
    <div class="check"><input data-save type="checkbox" data-key="a1_risco"> <span>Classifiquei cada um em baixo/m√©dio/alto risco</span></div>
    <div class="check"><input data-save type="checkbox" data-key="a1_fatores"> <span>Relacionei risco com sombra, uso e tampa</span></div>
    <div class="check"><input data-save type="checkbox" data-key="a1_acao"> <span>Propus uma a√ß√£o realista de manejo ambiental</span></div>
  `
},
{
  id:"agua_natural",
  title:"2Ô∏è‚É£ √Ågua natural ou semi-natural",
  sub:"Valetas, po√ßas, √°reas alagadas, margens",
  html:`
    <h3>O que caracteriza?</h3>
    <p>Ambientes em que a √°gua depende do clima, drenagem e din√¢mica do terreno (n√£o de recipientes).</p>

    <div class="eco">
      <b>Vetores e fases</b>
      <ul>
        <li>Mosquitos diversos</li>
        <li>Fase larval e adulta (dependendo do grupo)</li>
      </ul>
    </div>

    <h3>Por que isso √© estrat√©gico?</h3>
    <ul>
      <li>Podem sustentar popula√ß√µes de vetores fora do ‚Äúpico urbano‚Äù</li>
      <li>Conectam vigil√¢ncia a planejamento urbano, chuva e drenagem</li>
    </ul>

    <div class="callout">
      <b>Vigil√¢ncia inteligente</b>
      <p style="margin:6px 0 0">Nem todo foco √© elimin√°vel. Alguns s√£o <b>monitorados</b> com crit√©rio e seguran√ßa.</p>
    </div>

    <h3>Checklist</h3>
    <div class="check"><input data-save type="checkbox" data-key="a2_dif"> <span>Diferenciei natural vs. artificial</span></div>
    <div class="check"><input data-save type="checkbox" data-key="a2_chuva"> <span>Observei conex√£o com chuva e drenagem</span></div>
    <div class="check"><input data-save type="checkbox" data-key="a2_manejo"> <span>Avaliei: manejar ou apenas monitorar?</span></div>
    <div class="check"><input data-save type="checkbox" data-key="a2_sazon"> <span>Relacionei com sazonalidade</span></div>
  `
},
{
  id:"terrestre_sombra",
  title:"3Ô∏è‚É£ Terrestres e sombreados",
  sub:"Mat√©ria org√¢nica, folhas, solo √∫mido",
  html:`
    <h3>Caracter√≠sticas principais</h3>
    <p>Ambientes √∫midos, com mat√©ria org√¢nica e pouca luz. Muitas vezes ‚Äúinvis√≠veis‚Äù para a popula√ß√£o.</p>

    <div class="eco">
      <b>Vetores associados</b>
      <ul>
        <li>Flebotom√≠neos</li>
        <li>Outros insetos com import√¢ncia sanit√°ria local</li>
      </ul>
    </div>

    <h3>Por que s√£o dif√≠ceis?</h3>
    <ul>
      <li>N√£o t√™m √°gua ‚Äú√≥bvia‚Äù como criadouro</li>
      <li>Exigem olhar ecol√≥gico: sombra + umidade + abrigo</li>
    </ul>

    <div class="callout">
      <b>Conex√£o com sa√∫de</b>
      <p style="margin:6px 0 0">O ambiente pode favorecer ciclos de transmiss√£o em contextos espec√≠ficos (depende do territ√≥rio).</p>
    </div>

    <h3>Checklist</h3>
    <div class="check"><input data-save type="checkbox" data-key="a3_area"> <span>Identifiquei √°reas sombreadas e √∫midas</span></div>
    <div class="check"><input data-save type="checkbox" data-key="a3_org"> <span>Relacionei mat√©ria org√¢nica com abrigo</span></div>
    <div class="check"><input data-save type="checkbox" data-key="a3_risco"> <span>Diferenciei risco ambiental vs. domiciliar</span></div>
  `
},
{
  id:"domiciliar",
  title:"4Ô∏è‚É£ Domiciliares e peridomiciliares",
  sub:"Casas, quintais, anexos, dep√≥sitos",
  html:`
    <h3>Defini√ß√£o</h3>
    <p>Onde o contato humano‚Äìvetor √© mais direto. Aqui a vigil√¢ncia precisa de <b>cuidado social</b>.</p>

    <div class="eco">
      <b>Risco comum</b>
      <ul>
        <li>Mosquitos adultos em repouso</li>
        <li>Abrigos e microambientes no quintal</li>
      </ul>
    </div>

    <h3>Vigil√¢ncia √©tica</h3>
    <ul>
      <li>N√£o invadir</li>
      <li>N√£o humilhar</li>
      <li>Orientar com respeito e clareza</li>
    </ul>

    <div class="callout">
      <b>Sa√∫de p√∫blica √© parceria</b>
      <p style="margin:6px 0 0">Quando a pessoa entende o ‚Äúporqu√™‚Äù, ela vira parte da solu√ß√£o.</p>
    </div>

    <h3>Checklist</h3>
    <div class="check"><input data-save type="checkbox" data-key="a4_diff"> <span>Diferenciei domic√≠lio e peridomic√≠lio</span></div>
    <div class="check"><input data-save type="checkbox" data-key="a4_abrigo"> <span>Identifiquei poss√≠veis abrigos sem capturar insetos</span></div>
    <div class="check"><input data-save type="checkbox" data-key="a4_edu"> <span>Propus uma orienta√ß√£o educativa adequada</span></div>
  `
},
{
  id:"integracao",
  title:"5Ô∏è‚É£ Integra√ß√£o ecol√≥gica e decis√£o",
  sub:"Do ambiente ao controle da doen√ßa",
  html:`
    <h3>Integra√ß√£o final</h3>
    <p>Nenhum ambiente age sozinho. A vigil√¢ncia junta: <b>observa√ß√£o + registro + decis√£o</b>.</p>

    <div class="callout">
      <b>Pergunta-chave</b>
      <p style="margin:6px 0 0">Se voc√™ fosse a vigil√¢ncia municipal, o que faria com os dados do campo?</p>
    </div>

    <h3>Checklist final</h3>
    <div class="check"><input data-save type="checkbox" data-key="a5_rel"> <span>Relacionei ambiente, vetor e risco</span></div>
    <div class="check"><input data-save type="checkbox" data-key="a5_dec"> <span>Diferenciei eliminar, manejar e monitorar</span></div>
    <div class="check"><input data-save type="checkbox" data-key="a5_papel"> <span>Entendi o papel do campo na decis√£o</span></div>
    <div class="check"><input data-save type="checkbox" data-key="a5_exp"> <span>Consigo explicar isso para outra pessoa</span></div>
  `
}
];

/* ========= UI ========= */
const menu=document.getElementById("menu");
const title=document.getElementById("title");
const subtitle=document.getElementById("subtitle");
const content=document.getElementById("content");

const lessonPctEl = document.getElementById("lessonPct");
const modulePctEl = document.getElementById("modulePct");
const lessonBar = document.getElementById("lessonBar");
const moduleBar = document.getElementById("moduleBar");

const LS_PREFIX = "GV_CAMPO_";

/* salva e restaura checkboxes */
function restoreChecks(root){
  root.querySelectorAll('input[type="checkbox"][data-save][data-key]').forEach(cb=>{
    const k = LS_PREFIX + cb.dataset.key;
    cb.checked = localStorage.getItem(k) === "1";
    cb.addEventListener("change", ()=>{
      localStorage.setItem(k, cb.checked ? "1" : "0");
      updateProgress();
    });
  });
}

function countLessonChecks(){
  const all = content.querySelectorAll('input[type="checkbox"][data-save][data-key]');
  const done = [...all].filter(x=>x.checked).length;
  return {all: all.length, done};
}

function countModuleChecks(){
  const keys = lessons.flatMap(l=>{
    const tmp = document.createElement("div");
    tmp.innerHTML = l.html;
    return [...tmp.querySelectorAll('input[type="checkbox"][data-save][data-key]')].map(cb=>cb.dataset.key);
  });
  const unique = [...new Set(keys)];
  const done = unique.filter(k => localStorage.getItem(LS_PREFIX+k) === "1").length;
  return {all: unique.length, done};
}

function pct(done, all){
  if(!all) return 0;
  return Math.round((done/all)*100);
}

function updateProgress(){
  // li√ß√£o atual
  const L = countLessonChecks();
  const pL = pct(L.done, L.all);
  lessonPctEl.textContent = pL + "%";
  lessonBar.style.width = pL + "%";

  // m√≥dulo inteiro
  const M = countModuleChecks();
  const pM = pct(M.done, M.all);
  modulePctEl.textContent = pM + "%";
  moduleBar.style.width = pM + "%";
}

function openLesson(l){
  document.querySelectorAll(".lesson-btn").forEach(x=>x.classList.remove("active"));
  const btn = document.getElementById("btn_"+l.id);
  if(btn) btn.classList.add("active");

  title.textContent = l.title;
  subtitle.textContent = l.sub;
  content.innerHTML = l.html;

  restoreChecks(content);
  updateProgress();
}

/* monta menu */
lessons.forEach(l=>{
  const b=document.createElement("button");
  b.className="lesson-btn";
  b.id = "btn_"+l.id;
  b.innerHTML=`<b>${l.title}</b><span>${l.sub}</span>`;
  b.onclick=()=>openLesson(l);
  menu.appendChild(b);
});

/* abre primeiro por padr√£o */
openLesson(lessons[0]);
</script>

</body>
</html>

