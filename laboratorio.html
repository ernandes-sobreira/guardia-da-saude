<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Guardi√£s da Vigil√¢ncia üß¨ | M√≥dulo 3 ‚Äî Laborat√≥rio</title>
  <meta name="theme-color" content="#ec4899"/>

  <style>
    :root{
      --bg0:#fff7fb;
      --bg1:#ffe4f2;
      --card: rgba(255,255,255,.86);
      --stroke: rgba(120,20,80,.15);

      --txt:#3b0a2a;
      --muted: rgba(59,10,42,.65);

      --pink:#ec4899;
      --violet:#8b5cf6;
      --teal:#06b6d4;
      --green:#22c55e;
      --gold:#f59e0b;

      --r:20px;
      --shadow: 0 18px 60px rgba(120,20,80,.18);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      /* garante que o conte√∫do n√£o fique escondido atr√°s do menu autom√°tico */
      padding-bottom: 150px;

      background:
        radial-gradient(900px 600px at 10% 0%, rgba(236,72,153,.18), transparent 55%),
        radial-gradient(800px 600px at 90% 10%, rgba(139,92,246,.18), transparent 55%),
        linear-gradient(180deg,var(--bg0),var(--bg1));
      color:var(--txt);
    }
    a{color:var(--pink); font-weight:800}

    /* Header */
    header{
      position:sticky; top:0; z-index:30;
      background: rgba(255,247,251,.90);
      backdrop-filter: blur(10px);
      border-bottom:1px solid var(--stroke);
    }
    .header{
      max-width:1100px;
      margin:auto;
      padding:14px 16px;
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .hLeft{display:flex;gap:12px;align-items:center}
    .logo{
      width:46px;height:46px;
      border-radius:18px;
      display:grid;place-items:center;
      background:linear-gradient(135deg,var(--pink),var(--violet));
      color:white;
      font-size:22px;
      box-shadow:var(--shadow);
      flex:0 0 auto;
    }
    .header h1{ margin:0; font-size:16px; }
    .header p{
      margin:2px 0 0;
      font-size:12px;
      color:var(--muted);
    }

    /* progresso no header */
    .progWrap{
      min-width: 280px;
      max-width: 420px;
      flex: 1 1 340px;
      background: rgba(255,255,255,.6);
      border: 1px solid var(--stroke);
      border-radius: 16px;
      padding: 10px 12px;
    }
    .progTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom:8px;
    }
    .progTop b{font-size:12px}
    .progTop small{color:var(--muted);font-weight:800}
    .bar{
      width:100%;
      height:12px;
      background: rgba(140,20,90,.10);
      border-radius: 999px;
      overflow:hidden;
      border: 1px solid rgba(120,20,80,.12);
    }
    .fill{
      height:100%;
      width:0%;
      background: linear-gradient(135deg,var(--pink),var(--violet));
      border-radius: 999px;
      transition: width .25s ease;
    }
    .barRow{
      display:grid;
      gap:10px;
    }

    /* Layout */
    main{
      max-width:1100px;
      margin:auto;
      padding:16px 16px 24px;
      display:grid;
      grid-template-columns: 340px 1fr;
      gap:14px;
    }
    @media(max-width:900px){
      main{grid-template-columns:1fr}
      .progWrap{min-width: unset; max-width: unset}
    }

    /* Panels */
    .panel{
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius:var(--r);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .ph{
      padding:14px;
      border-bottom:1px solid var(--stroke);
    }
    .pb{ padding:12px; }
    .panel h2{ font-size:14px; margin:0; }

    /* Menu esquerdo */
    .lesson-btn{
      width:100%;
      text-align:left;
      padding:12px;
      margin-bottom:8px;
      border-radius:16px;
      border:1px solid transparent;
      background:rgba(255,255,255,.72);
      cursor:pointer;
      transition: transform .06s ease;
    }
    .lesson-btn:active{transform:scale(.99)}
    .lesson-btn.active{
      border-color:var(--pink);
      background:rgba(236,72,153,.12);
    }
    .lesson-btn b{display:block;font-size:13px}
    .lesson-btn span{font-size:12px;color:var(--muted)}

    /* Conte√∫do */
    .content{
      padding:16px;
      line-height:1.75;
    }
    .content h3{margin:14px 0 8px}
    .content ul{margin:8px 0 14px}
    .callout{
      background:rgba(236,72,153,.08);
      border-left:4px solid var(--pink);
      padding:12px;
      border-radius:14px;
      margin:12px 0;
    }
    .meta{
      background:rgba(6,182,212,.08);
      border-left:4px solid var(--teal);
      padding:12px;
      border-radius:14px;
      margin:12px 0;
    }
    .warn{
      background:rgba(245,158,11,.12);
      border-left:4px solid var(--gold);
      padding:12px;
      border-radius:14px;
      margin:12px 0;
    }

    /* checklist */
    .check{
      display:flex;
      gap:10px;
      margin:10px 0;
      align-items:flex-start;
      padding:10px 10px;
      border:1px dashed rgba(120,20,80,.18);
      border-radius:14px;
      background:rgba(255,255,255,.6);
    }
    .check input{ transform: translateY(2px); }

    .tools{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin:12px 0 0;
    }
    .btn{
      border:0;
      cursor:pointer;
      padding:10px 12px;
      border-radius:14px;
      font-weight:900;
      background:rgba(255,255,255,.78);
      border:1px solid var(--stroke);
      color:var(--txt);
    }
    .btn.primary{
      background:linear-gradient(135deg,var(--pink),var(--violet));
      color:white;
      border-color:transparent;
    }
    .hint{
      font-size:12px;
      color:var(--muted);
      margin-top:10px;
    }

    /* mini progresso dentro do painel direito */
    .miniProg{
      margin-top:10px;
      background: rgba(255,255,255,.55);
      border:1px solid var(--stroke);
      border-radius: 16px;
      padding: 10px 12px;
    }
    .miniProg .row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom:8px;
    }
    .miniProg .row b{font-size:12px}
    .miniProg .row small{color:var(--muted);font-weight:900}
  </style>
</head>

<body>

<header>
  <div class="header">
    <div class="hLeft">
      <div class="logo">üß¨</div>
      <div>
        <h1>M√≥dulo 3 ‚Äî Laborat√≥rio (8h)</h1>
        <p>Do campo ao microsc√≥pio: ci√™ncia feita por meninas</p>
      </div>
    </div>

    <!-- Progresso do M√≥dulo (diagn√≥stico) -->
    <div class="progWrap" aria-label="Progresso do m√≥dulo">
      <div class="progTop">
        <b>üìä Diagn√≥stico do m√≥dulo</b>
        <small id="modLabel">0%</small>
      </div>
      <div class="bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
        <div class="fill" id="modFill"></div>
      </div>
      <div class="hint" style="margin:8px 0 0">
        Progresso = itens do checklist marcados (todas as esta√ß√µes).
      </div>
    </div>
  </div>
</header>

<main>

  <!-- ESQUERDA -->
  <aside class="panel">
    <div class="ph">
      <h2>üî¨ Esta√ß√µes do Laborat√≥rio</h2>
      <p class="hint">Toque em uma esta√ß√£o para abrir. Checklists salvam automaticamente.</p>
    </div>
    <div class="pb" id="menu"></div>
  </aside>

  <!-- DIREITA -->
  <section class="panel">
    <div class="ph">
      <h2 id="title">Escolha uma esta√ß√£o</h2>
      <p id="subtitle" style="font-size:12px;color:var(--muted);margin:6px 0 0"></p>

      <!-- progresso da esta√ß√£o atual -->
      <div class="miniProg" id="miniProg" style="display:none">
        <div class="row">
          <b>‚úÖ Progresso da esta√ß√£o</b>
          <small id="staLabel">0%</small>
        </div>
        <div class="bar">
          <div class="fill" id="staFill"></div>
        </div>
        <div class="hint" style="margin-top:8px">
          As anota√ß√µes s√£o feitas no <b>Caderno</b> (bot√£o flutuante do app).
        </div>
      </div>
    </div>

    <div class="content" id="content">
      <div class="callout">
        <b>Como usar (para a B√°rbara conduzir aula)</b>
        <p style="margin:6px 0 0">
          1) Abra a esta√ß√£o ‚Üí 2) Leia em voz alta os blocos-chave ‚Üí 3) Fa√ßa as perguntas do ‚ÄúDesafio r√°pido‚Äù
          ‚Üí 4) As alunas marcam o checklist ‚Üí 5) Reflex√£o e registro no <b>Caderno global</b>.
        </p>
      </div>
      <div class="warn">
        <b>Lembrete importante</b>
        <p style="margin:6px 0 0">
          Nesta p√°gina <b>n√£o</b> tem campo de anota√ß√£o. As notas ficam <b>somente</b> no Caderno do app (um lugar s√≥).
        </p>
      </div>
    </div>
  </section>

</main>

<script>
  const STORAGE_PREFIX = "gv_lab_v2__"; // vers√£o nova

  const lessons = [
    {
      id:"L1",
      title:"Esta√ß√£o 1 ‚Äî Chegada do material ao laborat√≥rio",
      sub:"Organiza√ß√£o, biosseguran√ßa e respeito ao material",
      html:`
        <h3>Objetivo da esta√ß√£o</h3>
        <p>Transformar o material do campo em <b>amostra confi√°vel</b>. Aqui vale a regra:
        <b>sem organiza√ß√£o, n√£o existe dado</b>.</p>

        <div class="meta">
          <b>Biosseguran√ßa (simples e direta)</b>
          <ul>
            <li>Luvas quando indicado ‚Ä¢ cabelo preso ‚Ä¢ bancada limpa</li>
            <li>Nada de comida/bebida ‚Ä¢ nada de celular na bancada</li>
            <li>Evitar tocar no rosto durante a atividade</li>
            <li>Descarte correto do material (quando houver)</li>
          </ul>
        </div>

        <div class="callout">
          <b>Desafio r√°pido (B√°rbara pergunta / elas respondem)</b>
          <ul>
            <li>O que acontece com um dado sem etiqueta?</li>
            <li>Por que separar ‚Äú√°rea limpa‚Äù e ‚Äú√°rea suja‚Äù?</li>
          </ul>
        </div>

        <h3>Checklist da esta√ß√£o</h3>
        ${mkChecks("L1",[
          "Conferi se cada frasco/saco tem etiqueta m√≠nima (local + data + coletor).",
          "Separei amostras por tipo (larva / adulto / √°gua / substrato) sem misturar.",
          "Organizei a bancada com uma √°rea ‚Äúlimpa‚Äù e uma √°rea ‚Äúsuja‚Äù.",
          "Registrei problemas do material (vazamento, falta de r√≥tulo, dano)."
        ])}

        <div class="warn">
          <b>Registro no Caderno</b>
          <p style="margin:6px 0 0">
            Abra o <b>Caderno</b> do app e registre: ‚Äúo que chegou‚Äù, ‚Äúcomo foi organizado‚Äù e ‚Äúqual problema apareceu‚Äù.
          </p>
        </div>

        <div class="callout">
          <b>Link √∫til</b>
          <p style="margin:6px 0 0">
            Biblioteca Virtual em Sa√∫de (Minist√©rio da Sa√∫de):
            <a href="https://bvsms.saude.gov.br/" target="_blank" rel="noopener">bvsms.saude.gov.br</a>
          </p>
        </div>
      `
    },
    {
      id:"L2",
      title:"Esta√ß√£o 2 ‚Äî Rotulagem e registro cient√≠fico",
      sub:"Nomear, identificar e n√£o misturar informa√ß√µes",
      html:`
        <h3>Regra de ouro</h3>
        <p>Uma amostra sem informa√ß√£o vira ‚Äúcoisa‚Äù. Uma amostra bem rotulada vira <b>evid√™ncia</b>.</p>

        <div class="callout">
          <b>R√≥tulo m√≠nimo (sempre)</b>
          <ul>
            <li><b>C√≥digo</b> da amostra</li>
            <li><b>Local</b> (bairro + ponto)</li>
            <li><b>Data</b> e <b>hora</b></li>
            <li><b>Tipo</b> (larva/adulto/armadilha/recipiente)</li>
            <li><b>Quem coletou</b></li>
          </ul>
        </div>

        <div class="meta">
          <b>Desafio r√°pido</b>
          <ul>
            <li>Qual o risco de ‚Äúdois frascos com o mesmo c√≥digo‚Äù?</li>
            <li>Qual informa√ß√£o voc√™ NUNCA pode deixar faltar?</li>
          </ul>
        </div>

        <h3>Checklist</h3>
        ${mkChecks("L2",[
          "Criei um c√≥digo √∫nico para cada amostra (ex.: GV-2025-01).",
          "Consegui explicar a diferen√ßa entre ‚Äúr√≥tulo‚Äù e ‚Äúregistro no caderno/planilha‚Äù.",
          "N√£o deixei duas amostras com o mesmo c√≥digo.",
          "Separei amostras duvidosas (sem dados) para n√£o contaminar o estudo."
        ])}

        <div class="warn">
          <b>Registro no Caderno</b>
          <p style="margin:6px 0 0">
            No Caderno: escreva 1 exemplo completo de r√≥tulo + 1 erro comum que voc√™ evitaria.
          </p>
        </div>
      `
    },
    {
      id:"L3",
      title:"Esta√ß√£o 3 ‚Äî Observa√ß√£o em lupa e microsc√≥pio",
      sub:"Ver detalhes invis√≠veis a olho nu",
      html:`
        <h3>O que a lupa / microsc√≥pio revela?</h3>
        <p>Partes do corpo e formas (asas, antenas, segmentos) ajudam a reconhecer o <b>grupo</b> e entender risco.</p>

        <div class="meta">
          <b>N√£o precisa ‚Äúdecorar esp√©cie‚Äù</b>
          <p style="margin:6px 0 0">
            Aqui o foco √©: <b>grupo + ambiente + evid√™ncia</b>. Isso j√° orienta decis√£o em sa√∫de.
          </p>
        </div>

        <div class="callout">
          <b>Desafio r√°pido</b>
          <ul>
            <li>Que detalhe voc√™ viu que te deu certeza (e n√£o ‚Äúachismo‚Äù)?</li>
            <li>Como isso mudaria uma a√ß√£o no territ√≥rio?</li>
          </ul>
        </div>

        <h3>Checklist</h3>
        ${mkChecks("L3",[
          "Descrevi pelo menos 3 caracter√≠sticas observ√°veis (forma, movimento, tamanho etc.).",
          "Diferenciei ‚Äúlarva‚Äù de ‚Äúadulto‚Äù pelo que vi (sem chute).",
          "Registrei um desenho simples ou descri√ß√£o no meu Caderno.",
          "Mantive o material organizado e evitei tocar sem necessidade."
        ])}

        <div class="warn">
          <b>Registro no Caderno</b>
          <p style="margin:6px 0 0">
            No Caderno: ‚Äúo que eu vi‚Äù, ‚Äúqual grupo eu suspeito‚Äù e ‚Äúqual ambiente pode explicar isso‚Äù.
          </p>
        </div>
      `
    },
    {
      id:"L4",
      title:"Esta√ß√£o 4 ‚Äî Do dado √† decis√£o",
      sub:"Como a vigil√¢ncia usa o que voc√™ observou",
      html:`
        <h3>O dado vira a√ß√£o</h3>
        <ul>
          <li>Orienta√ß√£o √† comunidade (com respeito e sem culpa)</li>
          <li>Identifica√ß√£o de √°reas priorit√°rias</li>
          <li>Monitoramento ao longo do tempo</li>
          <li>Apoio a campanhas educativas e manejo ambiental</li>
        </ul>

        <div class="callout">
          <b>Pergunta poderosa</b>
          <p style="margin:6px 0 0">
            ‚ÄúSe eu fosse a vigil√¢ncia municipal, o que eu faria primeiro com esses achados?‚Äù
          </p>
        </div>

        <div class="meta">
          <b>Desafio r√°pido</b>
          <ul>
            <li>Esse achado pede <b>eliminar</b>, <b>manejar</b> ou <b>monitorar</b>?</li>
            <li>Qual a√ß√£o tem maior efeito com menor conflito social?</li>
          </ul>
        </div>

        <h3>Checklist</h3>
        ${mkChecks("L4",[
          "Liguei ambiente ‚Üí vetor ‚Üí doen√ßa em uma frase simples.",
          "Entendi que nem tudo se ‚Äúelimina‚Äù: √†s vezes se maneja ou monitora.",
          "Sugeri uma a√ß√£o pr√°tica que cabe na realidade do bairro.",
          "Consigo explicar para outra pessoa por que o laborat√≥rio importa."
        ])}

        <div class="warn">
          <b>Registro no Caderno</b>
          <p style="margin:6px 0 0">
            No Caderno: escreva 3 decis√µes poss√≠veis e justifique em 1 linha cada.
          </p>
        </div>
      `
    },
    {
      id:"L5",
      title:"Esta√ß√£o 5 ‚Äî Encerramento: mulheres na ci√™ncia e na sa√∫de",
      sub:"Voc√™ tamb√©m pode estar aqui",
      html:`
        <h3>Ci√™ncia √© lugar de mulher</h3>
        <p>Mulheres est√£o na pesquisa, na gest√£o, na inova√ß√£o e na sa√∫de p√∫blica. Precisamos de mais meninas nesses espa√ßos.</p>

        <div class="callout">
          <b>Mensagem final</b>
          <p style="margin:6px 0 0">Ser cientista √© observar, cuidar e transformar.</p>
        </div>

        <div class="meta">
          <b>Desafio r√°pido</b>
          <ul>
            <li>Qual parte do curso te deixou mais confiante?</li>
            <li>Que atitude voc√™ levaria para sua escola/casa?</li>
          </ul>
        </div>

        <h3>Checklist</h3>
        ${mkChecks("L5",[
          "Consigo dizer o que eu aprendi em 2 frases.",
          "Consigo explicar por que vigil√¢ncia salva vidas.",
          "Consigo imaginar um caminho para seguir na ci√™ncia/sa√∫de.",
          "Eu me sinto mais forte e capaz depois do curso."
        ])}

        <div class="warn">
          <b>Registro no Caderno</b>
          <p style="margin:6px 0 0">
            No Caderno: escreva uma promessa (‚ÄúA partir de hoje eu vou‚Ä¶‚Äù).
          </p>
        </div>
      `
    }
  ];

  function mkChecks(lessonId, items){
    return `
      <div class="checklist" data-lesson="${lessonId}">
        ${items.map((t,i)=>`
          <label class="check">
            <input type="checkbox" data-save="1" data-key="${lessonId}__ck${i}">
            <div>${t}</div>
          </label>
        `).join("")}
        <div class="tools">
          <button class="btn primary" type="button" data-action="save" data-lesson="${lessonId}">üíæ Salvar agora</button>
          <button class="btn" type="button" data-action="clear" data-lesson="${lessonId}">üßπ Limpar esta esta√ß√£o</button>
        </div>
        <div class="hint">‚úÖ Os checklists salvam automaticamente no seu celular.</div>
      </div>
    `;
  }

  const menu = document.getElementById("menu");
  const title = document.getElementById("title");
  const subtitle = document.getElementById("subtitle");
  const content = document.getElementById("content");

  // progresso
  const modFill = document.getElementById("modFill");
  const modLabel = document.getElementById("modLabel");
  const staFill = document.getElementById("staFill");
  const staLabel = document.getElementById("staLabel");
  const miniProg = document.getElementById("miniProg");

  let currentLessonId = null;

  function storageKey(k){ return STORAGE_PREFIX + k; }

  function restoreAll(){
    document.querySelectorAll('[data-save="1"]').forEach(el=>{
      const k = el.getAttribute("data-key");
      const v = localStorage.getItem(storageKey(k));
      if (v === null) return;
      if (el.type === "checkbox") el.checked = (v === "1");
    });
  }

  function saveOne(el){
    const k = el.getAttribute("data-key");
    if (!k) return;
    if (el.type === "checkbox") localStorage.setItem(storageKey(k), el.checked ? "1" : "0");
  }

  function countModuleProgress(){
    // conta todos os checkboxes de todas as esta√ß√µes (pela lista lessons)
    let total = 0;
    let done = 0;

    lessons.forEach(l=>{
      // cada esta√ß√£o tem 4 itens no checklist (neste modelo)
      // mas vamos contar pelo storage: para ser robusto, contamos pelo HTML quando aberto + pelo padr√£o de chaves.
      // Aqui: contamos pelo padr√£o de chaves ck0..ck99 at√© falhar (limite seguro 50)
      for(let i=0;i<50;i++){
        const key = `${l.id}__ck${i}`;
        const val = localStorage.getItem(storageKey(key));
        // consideramos "existente" quando j√° foi criado/visitado OU quando este ck faz parte do modelo.
        // Como temos 4 itens por esta√ß√£o, paramos no primeiro "buraco" depois que j√° encontrou algum.
        // Mais simples/seguro: usar o tamanho do checklist que existe no HTML da esta√ß√£o quando aberta.
      }
    });

    // forma correta: total baseado no modelo (itens que realmente existem)
    // vamos reconstruir total lendo o conte√∫do do objeto lessons via regex: conta "data-key=...__ck"
    // (r√°pido e confi√°vel)
    total = lessons.reduce((acc,l)=>{
      const m = (l.html.match(/__ck\d+/g) || []);
      // deduplicar por esta√ß√£o
      const uniq = new Set(m);
      return acc + uniq.size;
    },0);

    // done: contar localStorage = "1" para chaves existentes
    done = 0;
    lessons.forEach(l=>{
      const m = (l.html.match(/__ck\d+/g) || []);
      const uniq = Array.from(new Set(m));
      uniq.forEach(suf=>{
        const key = `${l.id}${suf}`; // ex: L1__ck0
        const val = localStorage.getItem(storageKey(key));
        if (val === "1") done++;
      });
    });

    return {done, total, pct: total ? Math.round((done/total)*100) : 0};
  }

  function countStationProgress(lessonId){
    const l = lessons.find(x=>x.id===lessonId);
    if(!l) return {done:0,total:0,pct:0};
    const m = (l.html.match(/__ck\d+/g) || []);
    const uniq = Array.from(new Set(m));
    const total = uniq.length;
    let done = 0;
    uniq.forEach(suf=>{
      const key = `${lessonId}${suf}`;
      const val = localStorage.getItem(storageKey(key));
      if (val === "1") done++;
    });
    return {done,total,pct: total ? Math.round((done/total)*100) : 0};
  }

  function renderProgress(){
    const mp = countModuleProgress();
    modFill.style.width = mp.pct + "%";
    modLabel.textContent = `${mp.pct}% (${mp.done}/${mp.total})`;

    if(currentLessonId){
      miniProg.style.display = "block";
      const sp = countStationProgress(currentLessonId);
      staFill.style.width = sp.pct + "%";
      staLabel.textContent = `${sp.pct}% (${sp.done}/${sp.total})`;
    }else{
      miniProg.style.display = "none";
    }
  }

  function attachAutosave(){
    document.querySelectorAll('[data-save="1"]').forEach(el=>{
      const handler = ()=>{
        saveOne(el);
        renderProgress();
      };
      el.addEventListener("change", handler);
    });

    document.querySelectorAll('[data-action="save"]').forEach(btn=>{
      btn.addEventListener("click", ()=>{
        // apenas confirma (os itens j√° salvam sozinhos)
        alert("‚úÖ Checklists salvos no seu celular!");
      });
    });

    document.querySelectorAll('[data-action="clear"]').forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const lessonId = btn.getAttribute("data-lesson");
        if (!confirm("Quer limpar apenas esta esta√ß√£o?")) return;

        // apaga chaves daquela esta√ß√£o
        Object.keys(localStorage).forEach(k=>{
          if (k.startsWith(STORAGE_PREFIX + lessonId + "__")) localStorage.removeItem(k);
        });

        // limpa tela
        document.querySelectorAll(`[data-key^="${lessonId}__"]`).forEach(el=>{
          if (el.type === "checkbox") el.checked = false;
        });

        renderProgress();
        alert("üßπ Esta√ß√£o limpa!");
      });
    });
  }

  function openLesson(l, btn){
    currentLessonId = l.id;

    document.querySelectorAll(".lesson-btn").forEach(x=>x.classList.remove("active"));
    btn.classList.add("active");
    title.textContent = l.title;
    subtitle.textContent = l.sub;
    content.innerHTML = l.html;

    restoreAll();
    attachAutosave();
    renderProgress();

    if (window.innerWidth < 900) window.scrollTo({top:0, behavior:"smooth"});
  }

  lessons.forEach((l,idx)=>{
    const b=document.createElement("button");
    b.className="lesson-btn";
    b.type="button";
    b.innerHTML=`<b>${l.title}</b><span>${l.sub}</span>`;
    b.addEventListener("click", ()=>openLesson(l,b));
    menu.appendChild(b);
    if (idx===0) setTimeout(()=>openLesson(l,b), 0);
  });

  // atualiza progresso mesmo antes de abrir (caso j√° tenha marca√ß√µes antigas)
  renderProgress();
</script>

<!-- Menu autom√°tico do seu app -->
<div id="app-menu"></div>
<script src="menu.js"></script>
<script src="caderno-global.js"></script>

</body>
</html>
