<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Desafio das Guardi√£s üéØ | Quiz</title>
<meta name="theme-color" content="#db2777"/>

<style>
:root{
  --bg0:#fff7fb;
  --bg1:#ffe4f2;
  --card: rgba(255,255,255,.92);
  --stroke: rgba(140,20,90,.18);
  --txt:#3b0a2a;
  --muted: rgba(59,10,42,.65);
  --pink:#db2777;
  --violet:#8b5cf6;
  --teal:#06b6d4;
  --green:#22c55e;
  --gold:#f59e0b;
  --red:#ef4444;
  --r:18px;
  --shadow: 0 18px 60px rgba(120,20,80,.18);
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:
    radial-gradient(900px 600px at 10% 0%, rgba(219,39,119,.18), transparent 55%),
    radial-gradient(800px 600px at 90% 10%, rgba(139,92,246,.18), transparent 55%),
    linear-gradient(180deg,var(--bg0),var(--bg1));
  color:var(--txt);
}
header{
  position:sticky; top:0; z-index:30;
  background: rgba(255,247,251,.92);
  backdrop-filter: blur(10px);
  border-bottom:1px solid var(--stroke);
}
.h{
  max-width:980px; margin:auto;
  padding:14px 16px;
  display:flex; gap:12px; align-items:center;
}
.badge{
  width:46px;height:46px;border-radius:18px;
  display:grid;place-items:center;
  background:linear-gradient(135deg,var(--pink),var(--violet));
  color:#fff;
  box-shadow:var(--shadow);
  font-size:22px;
}
.h h1{margin:0;font-size:16px}
.h p{margin:2px 0 0;font-size:12px;color:var(--muted)}

main{
  max-width:980px; margin:auto;
  padding:16px 16px 130px;
  display:grid; gap:14px;
}

.panel{
  background:var(--card);
  border:1px solid var(--stroke);
  border-radius:var(--r);
  box-shadow:var(--shadow);
  overflow:hidden;
}
.ph{
  padding:14px;
  border-bottom:1px solid var(--stroke);
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
  flex-wrap:wrap;
}
.ph h2{margin:0;font-size:14px}
.ph small{color:var(--muted)}
.pb{padding:14px}

.pills{display:flex; gap:8px; flex-wrap:wrap}
.pill{
  border:1px solid rgba(140,20,90,.16);
  background:rgba(255,255,255,.75);
  padding:10px 12px;
  border-radius:999px;
  cursor:pointer;
  font-weight:950;
  font-size:13px;
}
.pill.active{
  border:none;
  color:#fff;
  background:linear-gradient(135deg,var(--pink),var(--violet));
}

.kpis{
  display:grid;
  grid-template-columns: repeat(3,1fr);
  gap:10px;
}
@media(max-width:820px){ .kpis{grid-template-columns:1fr} }
.kpi{
  background:rgba(255,255,255,.75);
  border:1px solid rgba(140,20,90,.12);
  border-radius:16px;
  padding:10px;
}
.kpi b{display:block;font-size:12px;color:var(--muted)}
.kpi span{font-size:18px;font-weight:950}

.qCard{
  background:rgba(255,255,255,.78);
  border:1px solid rgba(140,20,90,.12);
  border-radius:18px;
  padding:14px;
}
.qTop{
  display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;
}
.tag{
  font-size:12px;
  padding:8px 10px;
  border-radius:999px;
  background:rgba(6,182,212,.10);
  border:1px solid rgba(6,182,212,.25);
  color:#0f5a66;
  font-weight:900;
}

.opt{
  display:grid;
  grid-template-columns: 22px 1fr;
  gap:10px;
  align-items:start;
  padding:12px;
  border-radius:16px;
  border:1px solid rgba(140,20,90,.12);
  background:rgba(255,255,255,.75);
  margin-top:10px;
  cursor:pointer;
}
.opt:hover{outline:2px solid rgba(219,39,119,.18)}
.opt input{width:18px;height:18px;margin-top:2px; pointer-events:none;}
.opt.correct{border-color: rgba(34,197,94,.55); background:rgba(34,197,94,.10)}
.opt.wrong{border-color: rgba(239,68,68,.55); background:rgba(239,68,68,.10)}
.opt.dim{opacity:.65}

hr{
  border:none;
  border-top:1px solid rgba(140,20,90,.12);
  margin:14px 0;
}

.callout{
  background:rgba(219,39,119,.08);
  border-left:4px solid var(--pink);
  padding:12px;
  border-radius:14px;
  margin:12px 0;
}
.tip{
  background:rgba(6,182,212,.10);
  border-left:4px solid var(--teal);
  padding:12px;
  border-radius:14px;
  margin:12px 0;
}
.warn{
  background:rgba(245,158,11,.12);
  border-left:4px solid var(--gold);
  padding:12px;
  border-radius:14px;
  margin:12px 0;
}

.btnRow{display:flex; gap:10px; flex-wrap:wrap}
.btn{
  border:none;
  border-radius:16px;
  padding:12px 14px;
  font-weight:950;
  cursor:pointer;
}
.btn.primary{
  background:linear-gradient(135deg,var(--pink),var(--violet));
  color:white;
}
.btn.ghost{
  background:rgba(255,255,255,.85);
  border:1px solid var(--stroke);
  color:var(--txt);
}
.btn.danger{
  background:rgba(239,68,68,.12);
  border:1px solid rgba(239,68,68,.35);
  color:#7a0f1d;
}

small{color:var(--muted)}
pre{white-space:pre-wrap}

footer{
  position:fixed;
  bottom:0; left:0; right:0;
  background: rgba(255,247,251,.95);
  border-top:1px solid var(--stroke);
}
.foot{
  max-width:980px;
  margin:auto;
  padding:10px;
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
.foot a{
  flex:1;
  text-align:center;
  text-decoration:none;
  padding:12px;
  border-radius:16px;
  font-weight:950;
  background:rgba(255,255,255,.75);
  border:1px solid rgba(140,20,90,.14);
  color:var(--txt);
}
.foot a.active{
  background:linear-gradient(135deg,var(--pink),var(--violet));
  color:#fff;
  border:none;
}
</style>
</head>

<body>

<header>
  <div class="h">
    <div class="badge">üéØ</div>
    <div>
      <h1>Desafio das Guardi√£s</h1>
      <p>Jogo de conhecimento ‚Äî embaralhado, com n√≠veis, explica√ß√µes e nota final</p>
    </div>
  </div>
</header>

<main>

<section class="panel">
  <div class="ph">
    <h2>Escolha o n√≠vel</h2>
    <small>As perguntas mudam e s√£o embaralhadas</small>
  </div>
  <div class="pb">
    <div class="pills">
      <button class="pill active" id="lvl_easy" onclick="setLevel('easy')">üå± Semente (f√°cil)</button>
      <button class="pill" id="lvl_mid" onclick="setLevel('mid')">üåø Trilha (m√©dio)</button>
      <button class="pill" id="lvl_hard" onclick="setLevel('hard')">üëë Coroa (dif√≠cil)</button>
    </div>

    <div class="kpis" style="margin-top:12px">
      <div class="kpi"><b>Quest√µes nesta rodada</b><span id="k_total">‚Äî</span></div>
      <div class="kpi"><b>Acertos</b><span id="k_hits">0</span></div>
      <div class="kpi"><b>Progresso</b><span id="k_prog">0%</span></div>
    </div>

    <div class="tip">
      <b>Regras do jogo</b>
      <div>1) Uma alternativa por quest√£o ‚Ä¢ 2) Voc√™ v√™ a explica√ß√£o ‚Ä¢ 3) No final sai a nota e seu ‚Äúselo‚Äù.</div>
    </div>

    <div class="btnRow">
      <button class="btn primary" onclick="start()">üöÄ Come√ßar rodada</button>
      <button class="btn ghost" onclick="resume()">‚ñ∂Ô∏è Continuar</button>
      <button class="btn danger" onclick="resetBest()">üßº Zerar recordes</button>
    </div>

    <div class="callout" id="bestBox" style="display:none"></div>
  </div>
</section>

<section class="panel">
  <div class="ph">
    <h2>Rodada</h2>
    <small id="roundInfo">Toque em ‚ÄúCome√ßar rodada‚Äù.</small>
  </div>
  <div class="pb" id="gameArea">
    <div class="qCard">
      <b>Pronta?</b>
      <p style="margin:8px 0 0">Escolha o n√≠vel e inicie. O jogo embaralha as perguntas e as alternativas.</p>
    </div>
  </div>
</section>

<section class="panel" id="finalPanel" style="display:none">
  <div class="ph">
    <h2>Resultado final</h2>
    <small>Seu selo e sua nota</small>
  </div>
  <div class="pb" id="finalBox"></div>
</section>

</main>

<footer>
  <div class="foot">
    <a href="index.html">üè† In√≠cio</a>
    <a href="teoria.html">üß† Teoria</a>
    <a href="campo.html">üå± Campo</a>
    <a href="indice-predial.html">üè¢ Protocolo</a>
    <a class="active" href="quiz.html">üéØ Desafio</a>
    <a href="laboratorio.html">üß¨ Lab</a>
  </div>
</footer>

<script>
/* ========= banco de quest√µes (30) =========
Formato:
{
  id, level: easy|mid|hard,
  topic,
  q,
  opts: [ {t, ok}, ... ],
  explain: "explica√ß√£o curta e forte",
  why: ["por que A...", "por que B..."]
}
*/
const QUESTIONS = [
  // ===== EASY (10) =====
  {
    id:"E1", level:"easy", topic:"SUS",
    q:"O SUS √© principalmente‚Ä¶",
    opts:[
      {t:"Uma rede que garante sa√∫de como direito e inclui preven√ß√£o, vigil√¢ncia e cuidado", ok:true},
      {t:"Apenas hospitais e pronto-socorro", ok:false},
      {t:"Um servi√ßo s√≥ para quem n√£o tem plano de sa√∫de", ok:false},
      {t:"Um programa tempor√°rio de vacina√ß√£o", ok:false},
    ],
    explain:"O SUS √© uma rede ampla: aten√ß√£o b√°sica, vigil√¢ncia, vacina√ß√£o, laborat√≥rios e cuidado.",
    why:[
      "Hospitais s√£o s√≥ uma parte do SUS.",
      "O SUS √© universal (para todos).",
      "Vacina√ß√£o √© componente, n√£o o todo."
    ]
  },
  {
    id:"E2", level:"easy", topic:"Vigil√¢ncia",
    q:"Vigil√¢ncia em Sa√∫de significa‚Ä¶",
    opts:[
      {t:"Observar riscos, detectar cedo e agir para prevenir/controle", ok:true},
      {t:"Somente registrar casos em planilhas", ok:false},
      {t:"Apenas fiscalizar com√©rcio", ok:false},
      {t:"Apenas fazer campanhas em redes sociais", ok:false},
    ],
    explain:"Vigil√¢ncia liga dados + territ√≥rio + decis√£o. N√£o √© s√≥ registro.",
    why:[
      "Registro √© parte, mas sem a√ß√£o n√£o vira vigil√¢ncia.",
      "Fiscaliza√ß√£o √© mais ligada √† vigil√¢ncia sanit√°ria, n√£o a toda vigil√¢ncia em sa√∫de.",
      "Comunica√ß√£o ajuda, mas n√£o substitui investiga√ß√£o e a√ß√£o."
    ]
  },
  {
    id:"E3", level:"easy", topic:"Arboviroses",
    q:"Uma arbovirose √©‚Ä¶",
    opts:[
      {t:"Doen√ßa transmitida por artr√≥podes, como mosquitos", ok:true},
      {t:"Doen√ßa transmitida apenas por √°gua contaminada", ok:false},
      {t:"Doen√ßa exclusivamente gen√©tica", ok:false},
      {t:"Doen√ßa causada por falta de vitamina", ok:false},
    ],
    explain:"Arboviroses envolvem vetor (ex.: mosquito) e v√≠rus circulando.",
    why:[
      "√Ågua pode influenciar criadouros, mas n√£o √© via de transmiss√£o direta.",
      "N√£o √© gen√©tica.",
      "N√£o √© por defici√™ncia vitam√≠nica."
    ]
  },
  {
    id:"E4", level:"easy", topic:"Ciclo",
    q:"No ciclo do mosquito urbano, as larvas vivem principalmente‚Ä¶",
    opts:[
      {t:"Na √°gua parada em recipientes", ok:true},
      {t:"No ar, voando", ok:false},
      {t:"Somente no solo seco", ok:false},
      {t:"Dentro de frutas", ok:false},
    ],
    explain:"Larvas precisam de √°gua para se desenvolver.",
    why:[
      "Voar √© fase adulta.",
      "Solo seco n√£o sustenta larvas de Aedes.",
      "N√£o √© um ciclo de frutas."
    ]
  },
  {
    id:"E5", level:"easy", topic:"Controle",
    q:"A forma mais direta de reduzir mosquito urbano √©‚Ä¶",
    opts:[
      {t:"Eliminar/vedar √°gua parada e manejar recipientes", ok:true},
      {t:"Apenas usar perfume forte", ok:false},
      {t:"Apenas pintar paredes", ok:false},
      {t:"Apenas abrir janelas", ok:false},
    ],
    explain:"Controle efetivo interrompe o ciclo: remove criadouros e reduz emerg√™ncia de adultos.",
    why:[
      "Perfume n√£o controla popula√ß√£o.",
      "Pintura n√£o remove criadouros.",
      "Ventila√ß√£o ajuda conforto, mas n√£o resolve foco."
    ]
  },
  {
    id:"E6", level:"easy", topic:"Fase cr√≠tica",
    q:"Encontrar pupas √© importante porque‚Ä¶",
    opts:[
      {t:"O adulto est√° prestes a emergir, aumentando risco imediato", ok:true},
      {t:"Significa que o mosquito j√° morreu", ok:false},
      {t:"Significa que n√£o h√° mais transmiss√£o", ok:false},
      {t:"√â sinal de que o ambiente est√° seco", ok:false},
    ],
    explain:"Pupa √© a fase pr√©-adulta. √â um alerta de emerg√™ncia pr√≥xima.",
    why:[
      "Pupa n√£o √© morte.",
      "Transmiss√£o pode aumentar quando adultos emergem.",
      "Pupas dependem de √°gua."
    ]
  },
  {
    id:"E7", level:"easy", topic:"Armadilhas",
    q:"Ovitrampa serve principalmente para‚Ä¶",
    opts:[
      {t:"Indicar atividade de postura de ovos (presen√ßa/reprodu√ß√£o)", ok:true},
      {t:"Capturar peixes", ok:false},
      {t:"Medir qualidade do ar", ok:false},
      {t:"Substituir totalmente inspe√ß√£o predial", ok:false},
    ],
    explain:"Ovitrampa √© monitoramento de postura, n√£o substitui todas as outras a√ß√µes.",
    why:[
      "N√£o tem rela√ß√£o com pesca.",
      "N√£o mede ar.",
      "Inspe√ß√£o ainda √© necess√°ria para localizar recipientes."
    ]
  },
  {
    id:"E8", level:"easy", topic:"Febre Amarela",
    q:"Na febre amarela, uma a√ß√£o central de preven√ß√£o √©‚Ä¶",
    opts:[
      {t:"Vacina√ß√£o em √°reas indicadas", ok:true},
      {t:"Somente tomar antibi√≥tico", ok:false},
      {t:"Somente beber mais √°gua", ok:false},
      {t:"Somente usar repelente uma vez por m√™s", ok:false},
    ],
    explain:"A vacina √© um pilar para febre amarela em √°reas recomendadas pelas autoridades.",
    why:[
      "Antibi√≥tico n√£o trata v√≠rus.",
      "Hidrata√ß√£o ajuda sintomas, mas n√£o previne circula√ß√£o viral.",
      "Repelente ajuda, mas n√£o substitui vacina√ß√£o quando indicada."
    ]
  },
  {
    id:"E9", level:"easy", topic:"Vigil√¢ncia Ambiental",
    q:"Um exemplo de fator ambiental que aumenta risco de arboviroses √©‚Ä¶",
    opts:[
      {t:"Ac√∫mulo de recipientes e √°gua parada em √°reas urbanas", ok:true},
      {t:"Apenas a cor das casas", ok:false},
      {t:"Apenas o n√∫mero de carros", ok:false},
      {t:"Apenas o tipo de m√∫sica do bairro", ok:false},
    ],
    explain:"Ambiente urbano com √°gua parada e res√≠duos cria criadouros e aumenta risco.",
    why:[
      "Cor de casa n√£o √© determinante.",
      "Carros podem influenciar mobilidade, mas n√£o √© o fator principal do vetor.",
      "M√∫sica n√£o tem rela√ß√£o."
    ]
  },
  {
    id:"E10", level:"easy", topic:"Conceito-chave",
    q:"A frase ‚Äòentender o ciclo √© entender onde procurar‚Äô significa‚Ä¶",
    opts:[
      {t:"O habitat muda por fase; cada fase pede busca e a√ß√£o diferentes", ok:true},
      {t:"Que s√≥ precisa olhar adultos", ok:false},
      {t:"Que s√≥ precisa olhar larvas", ok:false},
      {t:"Que n√£o precisa de vigil√¢ncia, s√≥ sorte", ok:false},
    ],
    explain:"Ciclo ‚Üí fase ‚Üí habitat ‚Üí t√©cnica ‚Üí decis√£o.",
    why:[
      "Olhar s√≥ adultos perde a fonte (criadouro).",
      "Olhar s√≥ larvas perde a atividade adulta e risco imediato.",
      "Vigil√¢ncia √© m√©todo, n√£o sorte."
    ]
  },

  // ===== MID (10) =====
  {
    id:"M1", level:"mid", topic:"Vigil√¢ncias",
    q:"Qual combina√ß√£o est√° correta?",
    opts:[
      {t:"Epidemiol√≥gica (casos) + Entomol√≥gica (vetores) + Ambiental (contexto)", ok:true},
      {t:"Epidemiol√≥gica (produtos) + Sanit√°ria (casos) + Ambiental (bancos)", ok:false},
      {t:"Entomol√≥gica (somente hospital) + Ambiental (somente laborat√≥rio)", ok:false},
      {t:"Sanit√°ria (mosquitos) + Entomol√≥gica (vacinas) + Ambiental (cirurgias)", ok:false},
    ],
    explain:"Cada vigil√¢ncia tem foco diferente e elas se complementam.",
    why:[
      "Produtos/servi√ßos n√£o s√£o vigil√¢ncia epidemiol√≥gica.",
      "Hospital e laborat√≥rio n√£o definem sozinhos os campos.",
      "Vacinas n√£o s√£o ‚Äòentomologia‚Äô."
    ]
  },
  {
    id:"M2", level:"mid", topic:"√çndices",
    q:"O √çndice Predial (IP/House Index) se refere a‚Ä¶",
    opts:[
      {t:"% de im√≥veis com presen√ßa de larvas/pupas em rela√ß√£o aos inspecionados", ok:true},
      {t:"% de pessoas vacinadas no bairro", ok:false},
      {t:"% de lixo reciclado na cidade", ok:false},
      {t:"N√∫mero total de mosquitos adultos capturados por noite", ok:false},
    ],
    explain:"IP √© propor√ß√£o de im√≥veis positivos entre os inspecionados.",
    why:[
      "Vacina√ß√£o √© outro indicador.",
      "Reciclagem √© ambiental, n√£o √≠ndice entomol√≥gico cl√°ssico.",
      "Captura de adultos √© outro tipo de monitoramento."
    ]
  },
  {
    id:"M3", level:"mid", topic:"Breteau",
    q:"O √çndice de Breteau (IB) √© √∫til porque‚Ä¶",
    opts:[
      {t:"Relaciona recipientes positivos ao n√∫mero de im√≥veis inspecionados (press√£o de criadouros)", ok:true},
      {t:"Conta apenas adultos no c√©u", ok:false},
      {t:"Mede somente chuva", ok:false},
      {t:"Substitui totalmente a vigil√¢ncia epidemiol√≥gica", ok:false},
    ],
    explain:"IB ajuda a entender ‚Äòquantos focos‚Äô existem por conjunto de im√≥veis.",
    why:[
      "N√£o √© contagem de adultos.",
      "N√£o √© √≠ndice clim√°tico.",
      "Vigil√¢ncias se complementam."
    ]
  },
  {
    id:"M4", level:"mid", topic:"Armadilhas",
    q:"A armadilha CDC √© mais associada a‚Ä¶",
    opts:[
      {t:"Captura de insetos adultos (atividade no ambiente)", ok:true},
      {t:"Detec√ß√£o de ovos em parede de recipientes", ok:false},
      {t:"Coleta de larvas dentro de ralos com √°gua", ok:false},
      {t:"Medi√ß√£o de pH da √°gua", ok:false},
    ],
    explain:"CDC foca em adultos, geralmente no per√≠odo noturno/ambientes espec√≠ficos.",
    why:[
      "Ovos ‚Üí ovitrampa/inspe√ß√£o.",
      "Larvas ‚Üí inspe√ß√£o/larvoscopia.",
      "pH n√£o √© objetivo da CDC."
    ]
  },
  {
    id:"M5", level:"mid", topic:"Ambiente",
    q:"Por que recipientes em √°rea sombreada podem ser mais problem√°ticos?",
    opts:[
      {t:"Sombra reduz evapora√ß√£o e cria microclima favor√°vel ao vetor", ok:true},
      {t:"Porque sombra mata larvas", ok:false},
      {t:"Porque sombra impede qualquer reprodu√ß√£o", ok:false},
      {t:"Porque sombra elimina √°gua parada", ok:false},
    ],
    explain:"Sombra = √°gua dura mais + abrigo para adultos.",
    why:[
      "Sombra n√£o mata larvas automaticamente.",
      "N√£o impede reprodu√ß√£o.",
      "N√£o elimina √°gua."
    ]
  },
  {
    id:"M6", level:"mid", topic:"Ciclo e decis√£o",
    q:"Voc√™ encontrou pupas e muitos recipientes com √°gua parada artificial. A decis√£o mais coerente √©‚Ä¶",
    opts:[
      {t:"Interven√ß√£o imediata (elimina√ß√£o/veda√ß√£o) + orienta√ß√£o e retorno curto", ok:true},
      {t:"Ignorar porque pupas n√£o importam", ok:false},
      {t:"Esperar 2 meses para ver se passa", ok:false},
      {t:"Focar apenas em cartazes sem eliminar criadouros", ok:false},
    ],
    explain:"Pupa = risco imediato ‚Üí agir r√°pido e planejar retorno.",
    why:[
      "Pupas s√£o sinal de emerg√™ncia pr√≥xima.",
      "Tempo longo deixa a popula√ß√£o crescer.",
      "Comunica√ß√£o sem manejo ambiental perde efic√°cia."
    ]
  },
  {
    id:"M7", level:"mid", topic:"Oropouche",
    q:"Qual frase √© mais correta sobre Oropouche?",
    opts:[
      {t:"√â uma arbovirose com din√¢mica de vetores e ambiente; vigil√¢ncia √© essencial", ok:true},
      {t:"√â sempre transmitida por √°gua contaminada", ok:false},
      {t:"N√£o tem rela√ß√£o com vetores", ok:false},
      {t:"S√≥ acontece em pa√≠ses frios", ok:false},
    ],
    explain:"Oropouche envolve vetor/ambiente e precisa de vigil√¢ncia e investiga√ß√£o.",
    why:[
      "N√£o √© via h√≠drica direta.",
      "Tem rela√ß√£o com vetores.",
      "N√£o √© restrita a pa√≠ses frios."
    ]
  },
  {
    id:"M8", level:"mid", topic:"Vigil√¢ncia Ambiental",
    q:"Qual a√ß√£o √© t√≠pica de vigil√¢ncia ambiental na preven√ß√£o de arboviroses?",
    opts:[
      {t:"Mapear pontos de ac√∫mulo de √°gua/res√≠duos e articular manejo urbano", ok:true},
      {t:"Prescrever rem√©dio individual", ok:false},
      {t:"Fazer cirurgia", ok:false},
      {t:"Vender repelente no com√©rcio", ok:false},
    ],
    explain:"Vigil√¢ncia ambiental atua no contexto do territ√≥rio e seus determinantes.",
    why:[
      "Prescri√ß√£o e cirurgia s√£o aten√ß√£o √† sa√∫de, n√£o vigil√¢ncia ambiental.",
      "Vender repelente √© mercado; pode apoiar, mas n√£o define vigil√¢ncia."
    ]
  },
  {
    id:"M9", level:"mid", topic:"Comunica√ß√£o",
    q:"Qual comunica√ß√£o √© mais alinhada com SUS e vigil√¢ncia (sem culpar a pessoa)?",
    opts:[
      {t:"‚ÄòVamos juntas reduzir criadouros: a cidade e as casas precisam de solu√ß√µes de manejo‚Äô", ok:true},
      {t:"‚ÄòSe tem dengue √© culpa do morador‚Äô", ok:false},
      {t:"‚ÄòN√£o tem o que fazer, √© azar‚Äô", ok:false},
      {t:"‚ÄòS√≥ spray resolve tudo‚Äô", ok:false},
    ],
    explain:"A comunica√ß√£o boa √© coletiva, pr√°tica e respeitosa ‚Äî n√£o culpabiliza.",
    why:[
      "Culpar atrapalha ades√£o e justi√ßa social.",
      "N√£o √© azar: √© determinante territorial e biol√≥gico.",
      "Spray n√£o resolve fonte do problema."
    ]
  },
  {
    id:"M10", level:"mid", topic:"Integra√ß√£o",
    q:"O que significa integrar ‚Äòcampo + laborat√≥rio‚Äô na vigil√¢ncia?",
    opts:[
      {t:"Coletar/registrar no territ√≥rio e confirmar/organizar achados no laborat√≥rio para orientar decis√£o", ok:true},
      {t:"Fazer tudo s√≥ no laborat√≥rio sem ir a campo", ok:false},
      {t:"Fazer tudo s√≥ no campo sem registrar", ok:false},
      {t:"Fazer apenas apresenta√ß√µes bonitas", ok:false},
    ],
    explain:"Integra√ß√£o √© transformar observa√ß√£o em dado confi√°vel e a√ß√£o coerente.",
    why:[
      "Laborat√≥rio sem territ√≥rio perde contexto.",
      "Campo sem registro vira mem√≥ria, n√£o evid√™ncia.",
      "Apresenta√ß√£o √© produto, n√£o m√©todo."
    ]
  },

  // ===== HARD (10) =====
  {
    id:"H1", level:"hard", topic:"Estrat√©gia",
    q:"Voc√™ tem poucos recursos. Qual estrat√©gia tem maior impacto para mosquito urbano?",
    opts:[
      {t:"Priorizar elimina√ß√£o/veda√ß√£o de recipientes de alto risco (√°gua armazenada, pneus, calhas) + retorno curto", ok:true},
      {t:"Aplicar inseticida em toda a cidade sem diagn√≥stico", ok:false},
      {t:"Coletar somente adultos e ignorar criadouros", ok:false},
      {t:"Fazer apenas posts em redes sociais", ok:false},
    ],
    explain:"Maior impacto costuma vir de interromper a produ√ß√£o (criadouros priorit√°rios) com a√ß√£o focada.",
    why:[
      "Inseticida indiscriminado pode ter baixa efetividade e efeitos colaterais.",
      "Adultos sem controle de criadouros = reposi√ß√£o cont√≠nua.",
      "Comunica√ß√£o ajuda, mas n√£o substitui a√ß√£o."
    ]
  },
  {
    id:"H2", level:"hard", topic:"Interpreta√ß√£o",
    q:"Dois pr√©dios t√™m mesmo IP, mas um tem muito mais recipientes positivos. Qual leitura √© melhor?",
    opts:[
      {t:"O pr√©dio com mais recipientes positivos tem maior press√£o de criadouros e tende a demandar manejo mais intenso", ok:true},
      {t:"S√£o iguais em tudo", ok:false},
      {t:"O que importa √© s√≥ n√∫mero de pessoas no pr√©dio", ok:false},
      {t:"IP elimina necessidade de olhar recipientes", ok:false},
    ],
    explain:"IP √© uma parte; recipientes positivos detalham a ‚Äòpress√£o‚Äô do ambiente.",
    why:[
      "Mesma % de im√≥veis positivos pode esconder n√≠veis diferentes de criadouros.",
      "Popula√ß√£o importa, mas n√£o substitui diagn√≥stico entomol√≥gico.",
      "Recipientes s√£o o mecanismo do ciclo."
    ]
  },
  {
    id:"H3", level:"hard", topic:"Fase e tempo",
    q:"Qual achado sugere necessidade de a√ß√£o mais imediata?",
    opts:[
      {t:"Pupas presentes + √°gua parada artificial", ok:true},
      {t:"Somente ovos antigos em recipiente seco", ok:false},
      {t:"Somente um adulto isolado sem contexto", ok:false},
      {t:"Somente sombra sem √°gua", ok:false},
    ],
    explain:"Pupas indicam adultos prestes a emergir. √Ågua artificial alimenta o ciclo urbano.",
    why:[
      "Ovos s√£o importantes, mas o risco imediato aumenta com pupas.",
      "Adulto isolado pode ocorrer sem evid√™ncia de foco local.",
      "Sombra sem √°gua n√£o fecha o ciclo."
    ]
  },
  {
    id:"H4", level:"hard", topic:"Armadilhas e pergunta",
    q:"Se a pergunta √© ‚Äòh√° atividade reprodutiva de Aedes aqui?‚Äô, a ferramenta mais direta √©‚Ä¶",
    opts:[
      {t:"Ovitrampa", ok:true},
      {t:"CDC", ok:false},
      {t:"Term√¥metro", ok:false},
      {t:"Somente entrevista sem observa√ß√£o", ok:false},
    ],
    explain:"Ovitrampa mede postura de ovos (atividade reprodutiva).",
    why:[
      "CDC mede adultos, n√£o postura diretamente.",
      "Term√¥metro mede ambiente.",
      "Entrevista sem evid√™ncia √© fr√°gil."
    ]
  },
  {
    id:"H5", level:"hard", topic:"Ambiente urbano",
    q:"Qual combina√ß√£o descreve melhor um ‚Äòmicroambiente de risco‚Äô para mosquito urbano?",
    opts:[
      {t:"Sombra + √°gua parada em recipientes + proximidade humana", ok:true},
      {t:"Sol forte + vento + aus√™ncia de √°gua", ok:false},
      {t:"Ambiente seco sem recipientes", ok:false},
      {t:"Somente temperatura baixa", ok:false},
    ],
    explain:"Risco emerge quando habitat sustenta imaturos e adultos ficam perto de pessoas.",
    why:[
      "Sem √°gua e recipientes, n√£o h√° ciclo urbano t√≠pico.",
      "Seco e sem recipientes reduz criadouros.",
      "Temperatura sozinha n√£o cria foco."
    ]
  },
  {
    id:"H6", level:"hard", topic:"Justi√ßa sanit√°ria",
    q:"A frase mais alinhada com sa√∫de coletiva e justi√ßa √©‚Ä¶",
    opts:[
      {t:"‚ÄòReduzir arboviroses exige a√ß√µes no domic√≠lio e tamb√©m infraestrutura urbana e pol√≠ticas p√∫blicas‚Äô", ok:true},
      {t:"‚ÄòTudo se resolve com esfor√ßo individual‚Äô", ok:false},
      {t:"‚ÄòS√≥ quem mora em bairro pobre tem dengue‚Äô", ok:false},
      {t:"‚ÄòN√£o vale a pena vigiar, √© inevit√°vel‚Äô", ok:false},
    ],
    explain:"Determinantes estruturais (√°gua, lixo, drenagem) s√£o parte do risco.",
    why:[
      "Individual ajuda, mas n√£o substitui infraestrutura.",
      "Dengue pode ocorrer em diferentes contextos ‚Äî desigualdade aumenta vulnerabilidade.",
      "Vigil√¢ncia reduz risco e orienta a√ß√£o."
    ]
  },
  {
    id:"H7", level:"hard", topic:"Decis√£o",
    q:"Qual resposta √© mais coerente com vigil√¢ncia baseada em evid√™ncias?",
    opts:[
      {t:"Registrar achados (fase/recipiente/ambiente), calcular √≠ndices e recomendar a√ß√£o espec√≠fica", ok:true},
      {t:"Agir sem registrar para ganhar tempo", ok:false},
      {t:"Registrar sem agir porque ‚Äòn√£o √© minha fun√ß√£o‚Äô", ok:false},
      {t:"Escolher a√ß√£o pelo que ‚Äòparece‚Äô mais bonito", ok:false},
    ],
    explain:"Evid√™ncia + registro + a√ß√£o = vigil√¢ncia boa.",
    why:[
      "Sem registro, n√£o h√° rastreabilidade nem aprendizado.",
      "Sem a√ß√£o, registro vira arquivo morto.",
      "Est√©tica n√£o guia sa√∫de p√∫blica."
    ]
  },
  {
    id:"H8", level:"hard", topic:"Ciclos diferentes",
    q:"Qual afirma√ß√£o √© mais correta sobre flebotom√≠neos versus mosquitos urbanos?",
    opts:[
      {t:"Flebotom√≠neos se associam mais a solo √∫mido e mat√©ria org√¢nica; mosquitos urbanos a √°gua em recipientes", ok:true},
      {t:"Ambos dependem do mesmo tipo de criadouro (pneu)", ok:false},
      {t:"Flebotom√≠neos vivem sempre na √°gua parada", ok:false},
      {t:"Mosquitos urbanos n√£o t√™m fase aqu√°tica", ok:false},
    ],
    explain:"Ciclos diferentes ‚Üí estrat√©gias diferentes.",
    why:[
      "Nem sempre compartilham criadouro.",
      "Flebotom√≠neo n√£o √© ‚Äò√°gua parada‚Äô como regra.",
      "Mosquitos urbanos t√™m fase aqu√°tica (larva/pupa)."
    ]
  },
  {
    id:"H9", level:"hard", topic:"Leitura do dado",
    q:"Por que ‚Äòtempo de inspe√ß√£o‚Äô e ‚Äòt√©cnica usada‚Äô importam no relat√≥rio?",
    opts:[
      {t:"Porque influenciam a confian√ßa do resultado e a comparabilidade entre locais", ok:true},
      {t:"Porque servem s√≥ para enfeitar", ok:false},
      {t:"Porque substituem √≠ndices", ok:false},
      {t:"Porque n√£o mudam nada na interpreta√ß√£o", ok:false},
    ],
    explain:"Esfor√ßo e t√©cnica mudam chance de detectar e tornam compara√ß√µes mais honestas.",
    why:[
      "N√£o √© enfeite: √© m√©todo.",
      "N√£o substitui √≠ndice; complementa.",
      "Muda interpreta√ß√£o sim."
    ]
  },
  {
    id:"H10", level:"hard", topic:"SUS integrado",
    q:"Uma a√ß√£o integrada SUS‚Äìvigil√¢ncia para arboviroses envolve‚Ä¶",
    opts:[
      {t:"UBS + vigil√¢ncia + comunica√ß√£o + campo/lab + gest√£o territorial", ok:true},
      {t:"Apenas hospital", ok:false},
      {t:"Apenas laborat√≥rio", ok:false},
      {t:"Apenas notifica√ß√£o sem retorno", ok:false},
    ],
    explain:"Integra√ß√£o √© rede: cuidado, vigil√¢ncia, territ√≥rio e decis√£o.",
    why:[
      "Hospital sozinho √© resposta tardia.",
      "Laborat√≥rio sem a√ß√£o √© diagn√≥stico sem impacto.",
      "Notificar sem retorno quebra confian√ßa."
    ]
  },
];

/* ========= engine ========= */
const KEY = "guardias_desafio_quiz_v1";
const BEST = "guardias_desafio_quiz_best_v1";

let level = "easy";
let pool = [];
let idx = 0;
let hits = 0;
let answered = false;
let current = null;
let round = [];

function shuffle(arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}

function setLevel(l){
  level = l;
  document.getElementById("lvl_easy").classList.toggle("active", l==="easy");
  document.getElementById("lvl_mid").classList.toggle("active", l==="mid");
  document.getElementById("lvl_hard").classList.toggle("active", l==="hard");
  showBest();
}

function pickQuestions(){
  const all = QUESTIONS.filter(q=>q.level===level);
  // cada n√≠vel tem 10 fixas; embaralhar e usar todas
  return shuffle(all);
}

function start(){
  round = pickQuestions();
  idx = 0;
  hits = 0;
  answered = false;
  current = null;
  saveState();
  document.getElementById("finalPanel").style.display="none";
  render();
}

function resume(){
  const s = loadState();
  if(!s){ alert("N√£o h√° rodada salva. Clique em Come√ßar rodada."); return; }
  level = s.level;
  setLevel(level);
  round = s.round;
  idx = s.idx;
  hits = s.hits;
  answered = s.answered;
  current = s.current;
  document.getElementById("finalPanel").style.display = "none";
  render();
}

function saveState(){
  const s = { level, round, idx, hits, answered, current };
  localStorage.setItem(KEY, JSON.stringify(s));
}
function loadState(){
  try{ return JSON.parse(localStorage.getItem(KEY)||""); }catch(e){ return null; }
}

function showBest(){
  const b = JSON.parse(localStorage.getItem(BEST)||"{}");
  const best = b[level] || null;
  const box = document.getElementById("bestBox");
  if(!best){
    box.style.display="block";
    box.innerHTML = `<b>Recorde deste n√≠vel:</b> ainda n√£o existe. Fa√ßa a primeira rodada!`;
    return;
  }
  box.style.display="block";
  box.innerHTML = `<b>Recorde deste n√≠vel:</b> ${best.score}% ‚Ä¢ ${best.hits}/${best.total} ‚Ä¢ selo: <b>${best.badge}</b>`;
}

function resetBest(){
  if(!confirm("Zerar recordes de todos os n√≠veis neste celular?")) return;
  localStorage.removeItem(BEST);
  showBest();
  alert("Recordes zerados.");
}

function updateKpis(){
  document.getElementById("k_total").textContent = round.length ? round.length : "‚Äî";
  document.getElementById("k_hits").textContent = hits;
  const prog = round.length ? Math.round((idx/round.length)*100) : 0;
  document.getElementById("k_prog").textContent = prog + "%";
  document.getElementById("roundInfo").textContent =
    round.length ? `Quest√£o ${Math.min(idx+1, round.length)} de ${round.length} ‚Ä¢ n√≠vel: ${labelLevel(level)}` : "Toque em ‚ÄúCome√ßar rodada‚Äù.";
}

function labelLevel(l){
  if(l==="easy") return "Semente (f√°cil)";
  if(l==="mid") return "Trilha (m√©dio)";
  return "Coroa (dif√≠cil)";
}

function render(){
  updateKpis();
  showBest();

  const area = document.getElementById("gameArea");
  if(!round.length){
    area.innerHTML = `<div class="qCard"><b>Pronta?</b><p style="margin:8px 0 0">Escolha o n√≠vel e inicie.</p></div>`;
    return;
  }

  if(idx >= round.length){
    finish();
    return;
  }

  current = round[idx];
  const opts = shuffle(current.opts).map((o,i)=>({...o, _i:i}));
  // guardar ordem atual para corre√ß√£o
  current._opts = opts;

  const tagColor = current.level==="easy" ? "rgba(34,197,94,.12)"
                 : current.level==="mid" ? "rgba(245,158,11,.14)"
                 : "rgba(239,68,68,.12)";

  area.innerHTML = `
    <div class="qCard">
      <div class="qTop">
        <div><b>${current.q}</b><div style="margin-top:4px"><small>Tema: ${current.topic}</small></div></div>
        <div class="tag" style="background:${tagColor};border-color:rgba(140,20,90,.14)">
          ${labelLevel(current.level)}
        </div>
      </div>

      <div id="opts"></div>

      <div id="feedback" style="display:none"></div>

      <hr>

      <div class="btnRow">
        <button class="btn primary" id="btnNext" onclick="next()" disabled>‚û°Ô∏è Pr√≥xima</button>
        <button class="btn ghost" onclick="saveState(); alert('Rodada salva ‚úÖ')">üíæ Salvar</button>
      </div>
    </div>
  `;

  const wrap = document.getElementById("opts");
  opts.forEach((o,ix)=>{
    const id = `opt_${ix}`;
    const el = document.createElement("div");
    el.className = "opt";
    el.innerHTML = `<input type="radio" name="q"><div>${o.t}</div>`;
    el.onclick = ()=> choose(ix);
    wrap.appendChild(el);
  });

  answered = false;
  saveState();
}

function choose(ix){
  if(answered) return;
  answered = true;

  const optsEls = Array.from(document.querySelectorAll(".opt"));
  const picked = current._opts[ix];
  const isOk = picked.ok;

  // marcar estilos
  optsEls.forEach((el,i)=>{
    const o = current._opts[i];
    if(o.ok) el.classList.add("correct");
    if(i===ix && !o.ok) el.classList.add("wrong");
    if(i!==ix && !o.ok) el.classList.add("dim");
  });

  if(isOk) hits++;

  const fb = document.getElementById("feedback");
  fb.style.display="block";

  const title = isOk ? `‚úÖ Acertou!` : `‚ùå Quase!`;
  const color = isOk ? "var(--green)" : "var(--red)";
  const why = current.why && current.why.length ? current.why.map(x=>`‚Ä¢ ${x}`).join("\n") : "‚Ä¢ Siga estudando: o importante √© entender o porqu√™.";
  fb.innerHTML = `
    <div class="callout" style="border-left-color:${color}">
      <b>${title}</b>
      <div style="margin-top:6px">${current.explain}</div>
      <div class="tip" style="margin-top:10px">
        <b>Por que as outras n√£o s√£o a melhor resposta?</b>
        <pre style="margin:8px 0 0">${why}</pre>
      </div>
    </div>
  `;

  document.getElementById("btnNext").disabled = false;
  saveState();
  updateKpis();
}

function next(){
  if(!answered) return;
  idx++;
  answered = false;
  saveState();
  render();
}

function finish(){
  const total = round.length;
  const score = Math.round((hits/total)*100);
  const badge = score>=90 ? "üëë Guardi√£ Mestra"
              : score>=75 ? "üõ°Ô∏è Guardi√£ Estrat√©gica"
              : score>=60 ? "üåø Guardi√£ em Treino"
              : "üå± Guardi√£ Semente";

  // salvar recorde
  const best = JSON.parse(localStorage.getItem(BEST)||"{}");
  const prev = best[level];
  if(!prev || score>prev.score){
    best[level] = {score, hits, total, badge, at: new Date().toISOString()};
    localStorage.setItem(BEST, JSON.stringify(best));
  }
  localStorage.removeItem(KEY); // encerra rodada

  document.getElementById("finalPanel").style.display="block";
  document.getElementById("finalBox").innerHTML = `
    <div class="callout">
      <b>Seu resultado</b>
      <div style="margin-top:8px" class="kpis">
        <div class="kpi"><b>N√≠vel</b><span>${labelLevel(level)}</span></div>
        <div class="kpi"><b>Acertos</b><span>${hits}/${total}</span></div>
        <div class="kpi"><b>Nota</b><span>${score}%</span></div>
      </div>

      <div class="tip" style="margin-top:12px">
        <b>Selo do dia:</b> <span style="font-weight:950">${badge}</span>
        <div style="margin-top:6px"><small>Dica: repita o desafio em outro n√≠vel para comparar seu avan√ßo.</small></div>
      </div>

      <div class="btnRow" style="margin-top:10px">
        <button class="btn primary" onclick="start()">üîÅ Jogar novamente</button>
        <button class="btn ghost" onclick="window.scrollTo({top:0,behavior:'smooth'})">‚¨ÜÔ∏è Voltar ao topo</button>
      </div>
    </div>
  `;

  // mostrar recorde atualizado
  showBest();

  // mostrar tela final
  document.getElementById("gameArea").innerHTML = `
    <div class="qCard">
      <b>Rodada finalizada ‚úÖ</b>
      <p style="margin:8px 0 0">Veja seu resultado na se√ß√£o ‚ÄúResultado final‚Äù.</p>
    </div>
  `;
  updateKpis();
}

/* init */
showBest();
</script>
<div id="app-menu"></div>
<script src="menu.js"></script>
  <script src="salvar.js"></script>
</body>
</html>
